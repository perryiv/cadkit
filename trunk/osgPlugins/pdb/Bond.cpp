///////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2004, Adam Kubach
//  All rights reserved.
//  BSD License: http://www.opensource.org/licenses/bsd-license.html
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2004, Adam Kubach
//  All rights reserved.
//  BSD License: http://www.opensource.org/licenses/bsd-license.html
//
///////////////////////////////////////////////////////////////////////////////

#include "Bond.h"
#include "Atom.h"

#include <sstream>

Bond::Bond(const Atom& lhs, const Atom& rhs, int id)
{
  _id = id;
  _r = 0.15f;
  _h = this->_getHeight(lhs.getVec3(), rhs.getVec3());
  _point1 = lhs.getVec3();
  _point2 = rhs.getVec3();
}


///////////////////////////////////////////////////////////////////////////////
//
//  Constructor.
//
///////////////////////////////////////////////////////////////////////////////

Bond::~Bond()
{
}


///////////////////////////////////////////////////////////////////////////////
//
//  Returns data members as a string.
//
///////////////////////////////////////////////////////////////////////////////

const std::string Bond::toString() const
{
  std::ostringstream out;
	out << _id <<" " << _h << " " << _r << " " << _point1[0] << " " <<  _point1[1] << " " <<  _point1[2];
	return std::string(out.str());
}

///////////////////////////////////////////////////////////////////////////////
//
//  Gets distance between two vectors.
//
///////////////////////////////////////////////////////////////////////////////

float Bond::_getHeight(const osg::Vec3& v1, const osg::Vec3& v0)
{
  float deltaX = v1[0] - v0[0];
  float deltaY = v1[1] - v0[1];
  float deltaZ = v1[2] - v0[2];
  return (float) sqrt((deltaX * deltaX) + (deltaY * deltaY) + (deltaZ * deltaZ));
}
