
///////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2005, Perry L Miller IV
//  All rights reserved.
//  BSD License: http://www.opensource.org/licenses/bsd-license.html
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
//  The wxWindows internal application class.
//
///////////////////////////////////////////////////////////////////////////////

#include "WxPrecompiled.h"
#include "WxInternalApp.h"
#include "WxInternalMainWin.h"
#include "WxApplication.h"
#include "WxObjectMap.h"
#include "AppFrameWork/Core/Define.h"


///////////////////////////////////////////////////////////////////////////////
//
//  Constructor.
//
///////////////////////////////////////////////////////////////////////////////

WxInternalApp::WxInternalApp() : BaseClass()
{
  // Add us to the map.
  WxObjectMap::set ( this, WxApplication::get() );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Destructor.
//
///////////////////////////////////////////////////////////////////////////////

WxInternalApp::~WxInternalApp()
{
  // Remove us from the map.
  WxObjectMap::remove ( this );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Called when the app is initialized.
//
///////////////////////////////////////////////////////////////////////////////

bool WxInternalApp::OnInit()
{
  try
  {
    return BaseClass::OnInit();
  }

  // Catch exceptions.
  AFW_CATCH_BLOCK ( 1284571148ul );

  // Initialization failed.
  return false;
}


///////////////////////////////////////////////////////////////////////////////
//
//  Called when the app is initialized.
//
///////////////////////////////////////////////////////////////////////////////

int WxInternalApp::OnExit()
{
  try
  {
    return BaseClass::OnExit();
  }

  // Catch exceptions.
  AFW_CATCH_BLOCK ( 1140043374ul );

  // Cleanup failed.
  return 1;
}


///////////////////////////////////////////////////////////////////////////////
//
//  Called during idle processing.
//
///////////////////////////////////////////////////////////////////////////////

bool WxInternalApp::ProcessIdle()
{
  try
  {
    WxApplication::RefPtr app ( WxApplication::get() );
    if ( app.valid() )
      app->eventsFlush();
  }

  // Catch exceptions.
  AFW_CATCH_BLOCK ( 2912104756ul );

  // Pass along to base class.
  return BaseClass::ProcessIdle();
}


///////////////////////////////////////////////////////////////////////////////
//
//  Handle events safely.
//
///////////////////////////////////////////////////////////////////////////////

void WxInternalApp::HandleEvent ( wxEvtHandler *handler, wxEventFunction func, wxEvent &event ) const
{
  // Safely...
  try
  {
    BaseClass::HandleEvent ( handler, func, event );
  }

  // Catch all exceptions.
  AFW_CATCH_BLOCK ( 1132381514ul );
}
