
///////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2007, Arizona State University
//  All rights reserved.
//  BSD License: http://www.opensource.org/licenses/bsd-license.html
//  Created by: Adam Kubach
//
///////////////////////////////////////////////////////////////////////////////

#include "WmsLayer.h"

#include "Usul/Strings/ManagedToNative.h"

#include "Magrathea/WmsLayer.h"

using namespace CadKit::OSSIMPlanet::Glue;


///////////////////////////////////////////////////////////////////////////////
//
//  Constructor.
//
///////////////////////////////////////////////////////////////////////////////

WmsLayer::WmsLayer() : _wmsImageLayer ( new Magrathea::WmsLayer )
{
  _wmsImageLayer->ref();
  _wmsImageLayer->transparentFlag( true );

  _wmsImageLayer->transparentColorFlag ( true );
  _wmsImageLayer->transparentColor ( 255, 255, 255 );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Constructor.
//
///////////////////////////////////////////////////////////////////////////////

WmsLayer::WmsLayer( Magrathea::WmsLayer* layer ) : _wmsImageLayer ( layer )
{
  _wmsImageLayer->ref();
  _wmsImageLayer->transparentFlag( true );

  _wmsImageLayer->transparentColorFlag ( true );
  _wmsImageLayer->transparentColor ( 255, 255, 255 );
}



///////////////////////////////////////////////////////////////////////////////
//
//  Destructor.
//
///////////////////////////////////////////////////////////////////////////////

WmsLayer::~WmsLayer()
{
  if( 0x0 != _wmsImageLayer )
  {
    _wmsImageLayer->unref();
    _wmsImageLayer = 0x0;
  }
}


///////////////////////////////////////////////////////////////////////////////
//
//  Finalizer.
//
///////////////////////////////////////////////////////////////////////////////

WmsLayer::!WmsLayer()
{
  if( 0x0 != _wmsImageLayer )
  {
    _wmsImageLayer->unref();
    _wmsImageLayer = 0x0;
  }
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the Guid.
//
///////////////////////////////////////////////////////////////////////////////

System::String^ WmsLayer::Guid::get()
{
  return gcnew System::String ( _wmsImageLayer->guid().c_str() );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the name.
//
///////////////////////////////////////////////////////////////////////////////

System::String^ WmsLayer::Name::get()
{
  return this->Server;
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the shown flag.
//
///////////////////////////////////////////////////////////////////////////////

bool WmsLayer::Shown::get()
{
  return true;
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the native pointer.
//
///////////////////////////////////////////////////////////////////////////////

System::IntPtr WmsLayer::nativeIntPtr()
{
  return System::IntPtr ( _wmsImageLayer->queryInterface( Usul::Interfaces::IUnknown::IID ) );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the server.
//
///////////////////////////////////////////////////////////////////////////////

System::String^ WmsLayer::Server::get()
{
  return gcnew System::String ( _wmsImageLayer->server().c_str() );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Set the server.
//
///////////////////////////////////////////////////////////////////////////////

void WmsLayer::Server::set( System::String^ s )
{
  _wmsImageLayer->server ( Usul::Strings::convert( s ) );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the cache directory.
//
///////////////////////////////////////////////////////////////////////////////

System::String^ WmsLayer::CacheDirectory::get()
{
  return gcnew System::String ( _wmsImageLayer->cacheDirectory().c_str() );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Set the cache directory.
//
///////////////////////////////////////////////////////////////////////////////

void WmsLayer::CacheDirectory::set ( System::String^ s )
{
  _wmsImageLayer->cacheDirectory( Usul::Strings::convert( s ).c_str() );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the image type.
//
///////////////////////////////////////////////////////////////////////////////

System::String^ WmsLayer::ImageType::get()
{
  return gcnew System::String ( _wmsImageLayer->imageType().c_str() );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Set the image type.
//
///////////////////////////////////////////////////////////////////////////////

void WmsLayer::ImageType::set ( System::String^ s )
{
  std::string imageType ( Usul::Strings::convert( s ) );
  _wmsImageLayer->imageType( imageType.c_str() );
}

