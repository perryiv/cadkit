
///////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2008, Arizona State University
//  All rights reserved.
//  BSD License: http://www.opensource.org/licenses/bsd-license.html
//  Author: Adam Kubach
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
//  Command to toggle the visibility.
//
///////////////////////////////////////////////////////////////////////////////

#include "Helios/Qt/Commands/WorkOffline.h"

#include "Usul/Trace/Trace.h"
#include "Usul/Registry/Database.h"

using namespace CadKit::Helios::Commands;

USUL_IMPLEMENT_COMMAND ( WorkOffline );


///////////////////////////////////////////////////////////////////////////////
//
//  Constructor.
//
///////////////////////////////////////////////////////////////////////////////

WorkOffline::WorkOffline() : BaseClass ( 0x0 )
{
  USUL_TRACE_SCOPE;

  this->text ( "Work Offline" );
  this->statusTip ( "Toggle work offline state." );
  this->toolTip ( "Toggle work offline state." );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Destructor.
//
///////////////////////////////////////////////////////////////////////////////

WorkOffline::~WorkOffline ()
{
  USUL_TRACE_SCOPE;
}


///////////////////////////////////////////////////////////////////////////////
//
//  Toggle the visibiity.
//
///////////////////////////////////////////////////////////////////////////////

void WorkOffline::_execute ()
{
  USUL_TRACE_SCOPE;

	// Toggle the state.
	const bool workOffline ( Usul::Registry::Database::instance()["work_offline"].get<bool> ( false, true ) );
	Usul::Registry::Database::instance()["work_offline"] = !workOffline;
}


///////////////////////////////////////////////////////////////////////////////
//
//  Are we enabled?
//
///////////////////////////////////////////////////////////////////////////////

bool WorkOffline::updateEnable () const
{
  return true;
}


///////////////////////////////////////////////////////////////////////////////
//
//  Are we enabled?
//
///////////////////////////////////////////////////////////////////////////////

bool WorkOffline::updateCheck () const
{
	return Usul::Registry::Database::instance()["work_offline"].get<bool> ( false, true );
}
