
///////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2005, Perry L Miller IV
//  All rights reserved.
//  BSD License: http://www.opensource.org/licenses/bsd-license.html
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
//  The wxWindows text window class.
//
///////////////////////////////////////////////////////////////////////////////

#include "WxPrecompiled.h"
#include "WxTextWindow.h"
#include "WxObjectMap.h"
#include "WxMainWindow.h"

#include "Usul/Errors/Assert.h"

AFW_IMPLEMENT_OBJECT ( WxTextWindow );


///////////////////////////////////////////////////////////////////////////////
//
//  Constructor.
//
///////////////////////////////////////////////////////////////////////////////

WxTextWindow::WxTextWindow() : BaseClass()
{
}


///////////////////////////////////////////////////////////////////////////////
//
//  Destructor.
//
///////////////////////////////////////////////////////////////////////////////

WxTextWindow::~WxTextWindow()
{
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the existing status bar.
//
///////////////////////////////////////////////////////////////////////////////

wxTextCtrl *WxTextWindow::get()
{
  Guard guard ( this->mutex() );
  return ( WxObjectMap::find<wxTextCtrl> ( this ) );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Get the existing status bar.
//
///////////////////////////////////////////////////////////////////////////////

const wxTextCtrl *WxTextWindow::get() const
{
  Guard guard ( this->mutex() );
  return ( WxObjectMap::find<wxTextCtrl> ( this ) );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Detach from gui object.
//
///////////////////////////////////////////////////////////////////////////////

void WxTextWindow::detach()
{
  WxObjectMap::remove ( this );
}


///////////////////////////////////////////////////////////////////////////////
//
//  Create the text window.
//
///////////////////////////////////////////////////////////////////////////////

bool WxTextWindow::create ( AFW::Core::Window *w )
{
  Guard guard ( this->mutex() );

  // Get the window.
  wxWindow *window ( WxObjectMap::find<wxFrame> ( w ) );
  if ( 0x0 == window )
    return false;

  // Don't create twice.
  if ( 0x0 != this->get() )
    return false;

  // Make a text control.
  std::auto_ptr<wxTextCtrl> text ( new wxTextCtrl ( window, wxID_ANY ) );

  // Set our status bar in the map.
  WxObjectMap::set ( this, text.release() );

  // It worked.
  return true;
}
